<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Table with Form</title>
<style>
  table {
    border-collapse: collapse;
    width: 100%;
  }
  th, td {
    border: 1px solid black;
    padding: 8px;
    text-align: center;
  }
  th {
    background-color: #f2f2f2;
  }
  th.header {
    text-align: center;
    background-color: #ddd;
    font-weight: bold;
    padding: 10px;
  }
  form {
    margin-bottom: 10px;
  }
  .error {
    color: red;
    margin-top: 5px;
  }
  .remove-button {
    background-color: #f44336;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
  }
  .actions-cell {
    width: 1%;
  }
</style>
</head>
<body>

<form id="dataForm">
  <label for="stateName">State Name:</label>
  <input type="text" id="stateName" required>
  <label for="stateValue">State Value:</label>
  <input type="number" id="stateValue" step="0.01" required>
  <button type="submit" id="addRowButton">Add Row</button>
  <p class="error" id="errorMessage"></p>
</form>

<table>
  <thead>
    <tr>
      <th class="header" colspan="3">Table Header</th>
    </tr>
    <tr>
      <th>Node</th>
      <th>Value</th>
      <th class="actions-cell">Actions</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <!-- No rows initially -->
  </tbody>
</table>

<script>
  const tableBody = document.getElementById("tableBody");
  let data = []; // Array to store dictionary objects

  const dataForm = document.getElementById("dataForm");
  const stateNameInput = document.getElementById("stateName");
  const stateValueInput = document.getElementById("stateValue");
  const addRowButton = document.getElementById("addRowButton");
  const errorMessage = document.getElementById("errorMessage");

  dataForm.addEventListener("submit", (event) => {
    event.preventDefault();

    const newStateName = stateNameInput.value;
    const newStateValue = parseFloat(stateValueInput.value);

    if (newStateName && !isNaN(newStateValue)) {
      const newRow = document.createElement("tr");
      const newNodeCell = document.createElement("td");
      const newValueCell = document.createElement("td");
      const actionsCell = document.createElement("td");

      const rowCount = tableBody.childElementCount + 1;
      data.push({ node: newStateName, value: newStateValue });

      newNodeCell.textContent = newStateName;
      newValueCell.textContent = newStateValue.toFixed(2);
      const removeButton = document.createElement("button");
      removeButton.textContent = "Remove Row";
      removeButton.className = "remove-button";
      removeButton.addEventListener("click", () => {
        tableBody.removeChild(newRow);
        data = data.filter(entry => entry.node !== newStateName); // Remove corresponding data entry
        updateSum();
      });
      actionsCell.appendChild(removeButton);

      newRow.appendChild(newNodeCell);
      newRow.appendChild(newValueCell);
      newRow.appendChild(actionsCell);

      tableBody.appendChild(newRow);

      // Clear form inputs
      stateNameInput.value = "";
      stateValueInput.value = "";

      updateSum();
    }
  });

  function updateSum() {
    const sum = data.reduce((total, entry) => total + entry.value, 0);
    if (sum >= 1) {
      addRowButton.disabled = true;
      errorMessage.textContent = "Sum of values is equal to or greater than 1.";
    } else {
      addRowButton.disabled = false;
      errorMessage.textContent = "";
    }
  }
</script>
<script></script>
</body>
</html>